{% extends "base.html" %}

{% block title %}Mis hÃ¡bitos - Habit Tracker{% endblock %}

{% block content %}
<h1>ğŸ“ˆ Hola, {{ usuario.nombre }}</h1>

<div class="nav">
    <a href="/habitos">ğŸ“ˆ HÃ¡bitos</a>
    <a href="/semanas">ğŸ“… Semanas</a>
    <a href="#" onclick="document.getElementById('modalEliminar').style.display='block'" style="margin-left: auto; color: #e53e3e;">âš™ï¸ Cuenta</a>
    <a href="/logout">ğŸšª Salir</a>
</div>

<h2>Tus hÃ¡bitos</h2>

{% if usuario.listar_habitos() %}
    {% for h in usuario.listar_habitos() %}
        <div class="habit-item">
            <div class="habit-info">
                <div class="habit-name">
                    {% if h.esta_completado_hoy() %}âœ…{% else %}â­•{% endif %} {{ h.nombre }}
                </div>
                <div class="habit-stats">
                    <span class="badge badge-streak">ğŸ”¥ Racha: {{ h.racha_actual() }} dÃ­as</span>
                    <span style="margin-left: 8px; color: #a0aec0;">Mejor: {{ h.mejor_racha() }} dÃ­as</span>
                </div>
            </div>
            <div class="actions">
                {% if not h.esta_completado_hoy() %}
                <form method="POST" action="/habito/completar">
                    <input type="hidden" name="nombre" value="{{ h.nombre }}">
                    <button type="submit" class="btn-small btn-success">âœ… Completar</button>
                </form>
                {% endif %}
                <form method="POST" action="/habito/eliminar" onsubmit="return confirm('Â¿Seguro que quieres eliminar este hÃ¡bito?');">
                    <input type="hidden" name="nombre" value="{{ h.nombre }}">
                    <button type="submit" class="btn-small btn-danger">ğŸ—‘ï¸</button>
                </form>
            </div>
        </div>
    {% endfor %}
{% else %}
    <div class="empty-state">
        <div class="empty-state-icon">ğŸŒ±</div>
        <p>No tienes hÃ¡bitos todavÃ­a</p>
        <p style="font-size: 0.875rem; margin-top: 8px;">Â¡Crea tu primer hÃ¡bito para empezar!</p>
    </div>
{% endif %}

<h3>â• Crear nuevo hÃ¡bito</h3>
<form method="POST" action="/habito/nuevo" style="display: flex; gap: 12px;" autocomplete="off">
    <input type="text" name="nombre" placeholder="Ej: Meditar 10 minutos" required style="flex: 1; margin-bottom: 0;" autocomplete="off">
    <button type="submit" class="btn-success">Crear</button>
</form>

<!-- Modal para eliminar cuenta -->
<div id="modalEliminar" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000;">
    <div style="max-width: 500px; margin: 100px auto; background: white; padding: 32px; border-radius: 16px; box-shadow: 0 20px 60px rgba(0,0,0,0.3);">
        <h2 style="color: #e53e3e; margin-top: 0;">âš ï¸ Eliminar cuenta</h2>
        <p style="color: #718096; margin-bottom: 24px;">Esta acciÃ³n es <strong>irreversible</strong>. Se eliminarÃ¡n todos tus hÃ¡bitos, semanas y datos.</p>
        
        <form method="POST" action="/cuenta/eliminar" autocomplete="off">
            <div class="form-group">
                <label for="confirmacion">Para confirmar, escribe tu nombre de usuario: <strong>{{ usuario.nombre }}</strong></label>
                <input type="text" id="confirmacion" name="confirmacion" placeholder="Tu nombre de usuario" required autocomplete="off">
            </div>
            
            <div style="display: flex; gap: 12px;">
                <button type="button" onclick="document.getElementById('modalEliminar').style.display='none'" style="flex: 1; background: #718096;">Cancelar</button>
                <button type="submit" class="btn-danger" style="flex: 1;">Eliminar cuenta</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}
